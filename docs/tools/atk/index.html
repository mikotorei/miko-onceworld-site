<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>与ダメージ計算 | OnceWorld(ワンスワ)miko</title>
  <link rel="stylesheet" href="https://matsumoto0106.github.io/miko-onceworld-site/css/style.css">
  <link rel="stylesheet" href="https://matsumoto0106.github.io/miko-onceworld-site/css/monster.css">


  
</head>
<body>

<header class="site-header">
  <h1 class="site-title">
    <a href="https://matsumoto0106.github.io/miko-onceworld-site/">
      OnceWorld(ワンスワ)miko
    </a>
  </h1>
</header>

<main style="padding:10px;">
  

<h1>与ダメージ計算</h1>

<div class="tool-container">
  <p>与ダメージを計算するツールです。</p>
<hr>
<section class="atk-tool">
  <h2>与ダメージ計算</h2>
  <div class="atk-form">
  <div class="form-row">
      <label for="monster-select">モンスター選択：</label>
      <select id="monster-select">
        <option value="">-- 選択してください --</option>
      
        
          
            <option value="100|200|200">
              BOX
            </option>
          
        
          
            <option value="8|28|30">
              アヌビス
            </option>
          
        
          
            <option value="9|4|15">
              アリクイロード
            </option>
          
        
          
            <option value="77|15|101">
              イージスリエル
            </option>
          
        
          
            <option value="22|46|48">
              イグニシア
            </option>
          
        
          
            <option value="55|112|121">
              イグニス・シスター
            </option>
          
        
          
            <option value="48|30|85">
              ウォーデン
            </option>
          
        
          
            <option value="11|71|96">
              うねうね
            </option>
          
        
          
            <option value="16|9|44">
              エジプトアシュラ
            </option>
          
        
          
            <option value="100|100|132">
              エレファントパラディン
            </option>
          
        
          
            <option value="39|99|159">
              オルド･クラウセス
            </option>
          
        
          
            <option value="7|5|14">
              オルトロス
            </option>
          
        
          
            <option value="26|65|58">
              ガチキメラ
            </option>
          
        
          
            <option value="29|22|69">
              ギガントオーク
            </option>
          
        
          
            <option value="99|40|95">
              キメラキング
            </option>
          
        
          
            <option value="11|3|8">
              キメラタートル
            </option>
          
        
          
            <option value="40|15|45">
              クリーチャーアイ
            </option>
          
        
          
            <option value="1|1|20">
              クリーチャーローズ
            </option>
          
        
          
            <option value="2|3|3">
              グリーンスライム
            </option>
          
        
          
            <option value="32|25|55">
              ケルベロス
            </option>
          
        
          
            <option value="13|23|40">
              ゴブリンクルー
            </option>
          
        
          
            <option value="3|3|3">
              ゴブリンメイジ
            </option>
          
        
          
            <option value="2|3|31">
              ゴブリン特攻隊
            </option>
          
        
          
            <option value="10|2|33">
              シカファイター
            </option>
          
        
          
            <option value="36|45|30">
              スカルウィスプ
            </option>
          
        
          
        
          
            <option value="11|31|135">
              スノーモケラ
            </option>
          
        
          
            <option value="5|14|14">
              ダークメイジ
            </option>
          
        
          
            <option value="25|36|40">
              ダイコンに見えるダイコン
            </option>
          
        
          
            <option value="15|9|43">
              デーモンブレイド
            </option>
          
        
          
            <option value="21|17|55">
              デザートイッヌ
            </option>
          
        
          
            <option value="26|20|76">
              ヌー
            </option>
          
        
          
            <option value="35|91|106">
              ネクロプリンセス
            </option>
          
        
          
            <option value="115|5|60">
              バーニングロック
            </option>
          
        
          
            <option value="17|23|35">
              ハネスライム
            </option>
          
        
          
            <option value="28|17|31">
              パンダ
            </option>
          
        
          
            <option value="16|19|28">
              ファイヤーメイジ
            </option>
          
        
          
            <option value="18|28|65">
              ファントムツリー
            </option>
          
        
          
            <option value="8|321|99">
              ブタ天使
            </option>
          
        
          
            <option value="29|28|66">
              フレイムフロッグ
            </option>
          
        
          
            <option value="48|48|38">
              フレイムボーン
            </option>
          
        
          
            <option value="1|1|1">
              ペリカンEXP
            </option>
          
        
          
            <option value="8|1|7">
              ペンギンソルジャー
            </option>
          
        
          
            <option value="15|20|38">
              ペンギンロード
            </option>
          
        
          
            <option value="50|12|50">
              ボーンバトラー
            </option>
          
        
          
            <option value="5|8|18">
              ボスゴブリン
            </option>
          
        
          
            <option value="15|9|38">
              ホネ
            </option>
          
        
          
            <option value="22|26|121">
              ホムラウマ
            </option>
          
        
          
            <option value="3|2|12">
              マッドカエル
            </option>
          
        
          
            <option value="29|39|84">
              ランプの精霊
            </option>
          
        
          
            <option value="2|2|4">
              レッドゴブリン
            </option>
          
        
          
            <option value="30|50|155">
              不思議なツボ
            </option>
          
        
          
        
          
            <option value="145|145|170">
              冥王ノクタール
            </option>
          
        
          
            <option value="19|1|22">
              動く墓
            </option>
          
        
          
            <option value="2|9|11">
              原始蝶
            </option>
          
        
          
            <option value="111|61|155">
              古代魚　ザコーン
            </option>
          
        
          
            <option value="31|36|56">
              天狗
            </option>
          
        
          
            <option value="30|17|45">
              居住者A
            </option>
          
        
          
            <option value="12|37|40">
              居住者B
            </option>
          
        
          
            <option value="89|3|68">
              悪夢の石像
            </option>
          
        
          
            <option value="59|69|111">
              捧げし者
            </option>
          
        
          
            <option value="46|66|130">
              支配のトリ
            </option>
          
        
          
            <option value="81|81|210">
              時空龍クロノゼリウス
            </option>
          
        
          
            <option value="85|105|155">
              朽ちざる竜骸　イゾ
            </option>
          
        
          
            <option value="17|17|26">
              死戦士マミー
            </option>
          
        
          
            <option value="26|130|156">
              残燃モエコ
            </option>
          
        
          
            <option value="25|35|173">
              深淵灯魚
            </option>
          
        
          
            <option value="80|21|102">
              炎鬼
            </option>
          
        
          
            <option value="31|41|56">
              烈火鼠
            </option>
          
        
          
            <option value="18|25|70">
              焼きトリ
            </option>
          
        
          
            <option value="15|90|44">
              燃えてる何か
            </option>
          
        
          
            <option value="75|105|75">
              禁域のアヌビシュ
            </option>
          
        
          
            <option value="101|100|101">
              禁域のヴァルネシア
            </option>
          
        
          
            <option value="74|184|104">
              禁域のクマヌイ
            </option>
          
        
          
            <option value="45|165|75">
              禁域のラミア
            </option>
          
        
          
            <option value="100|100|200">
              禁域の巨木
            </option>
          
        
          
            <option value="45|5|3">
              紅サソリ
            </option>
          
        
          
            <option value="74|115|180">
              聡明神　トモダチ
            </option>
          
        
          
            <option value="31|81|128">
              邪黒龍
            </option>
          
        
          
            <option value="4|15|15">
              鉄罠花
            </option>
          
        
          
            <option value="13|13|27">
              雪だるまん
            </option>
          
        
          
            <option value="88|188|130">
              零の者
            </option>
          
        
      
      </select>

    </div>
  <div class="form-row">
      <label for="monster-level">モンスターレベル：</label>
      <input type="number" id="monster-level" value="1" min="1">
    </div>
  <div class="form-row">
      <span>攻撃タイプ：</span>
      <label><input type="radio" name="attack-type" value="phys" checked> 物理（ATK）</label>
      <label><input type="radio" name="attack-type" value="magic"> 魔法（INT）</label>
    </div>
  <div class="form-row">
      <label for="atk">ATK：</label>
      <input type="number" id="atk" value="100" min="0">
    </div>
  <div class="form-row">
      <label for="int">INT：</label>
      <input type="number" id="int" value="100" min="0">
    </div>
  <div class="form-row">
      <label for="def">DEF：</label>
      <input type="number" id="def" value="0" min="0">
    </div>
  <div class="form-row">
      <label for="mdef">MDEF：</label>
      <input type="number" id="mdef" value="0" min="0">
    </div>
<p><button id="calc-btn">計算する</button></p>
  </div>
  <div class="atk-result">
    <p>対象モンスターVIT（レベル反映）：<span id="vit-display">---</span></p>
    <p>与ダメージ：<span id="result">---</span></p>
    <p id="minline">最低ライン：---</p>
</section>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const vitDisplayEl = document.getElementById("vit-display");
  const selectEl  = document.getElementById("monster-select");
  const levelEl   = document.getElementById("monster-level");
  const atkEl     = document.getElementById("atk");
  const intEl     = document.getElementById("int");
  const defEl     = document.getElementById("def");
  const mdefEl    = document.getElementById("mdef");
  const resultEl  = document.getElementById("result");
  const minlineEl = document.getElementById("minline");
  const calcBtn   = document.getElementById("calc-btn");

  // 要素不足なら何もしない（ページが壊れないように）
  if (!selectEl || !levelEl || !atkEl || !intEl || !defEl || !mdefEl || !resultEl || !minlineEl || !calcBtn || !vitDisplayEl) return;
  
  // モンスター基礎値（Lv1）
  let baseDef = 0;
  let baseMdef = 0;
  let baseVit = 0;

  // レベル補正：基礎×(1+(Lv-1)*0.1) を切り捨て
  function scaleByLevel(base, lv) {
    return Math.floor(base * (1 + (lv - 1) * 0.1));
  }

  function getLv() {
    return Math.max(1, Number(levelEl.value || 1));
  }

  function getAttackType() {
    const checked = document.querySelector('input[name="attack-type"]:checked');
    return checked ? checked.value : "phys";
  }

  // value="def|mdef" から基礎DEF/MDEFを読む
  function loadMonsterBases() {
  const opt = selectEl.options[selectEl.selectedIndex];
  const v = (opt?.value || "").trim(); // "def|mdef|vit"

  if (!v || !v.includes("|")) {
    baseDef = 0;
    baseMdef = 0;
    baseVit = 0;
    return;
  }

  const parts = v.split("|");
  baseDef = Number(parts[0] || 0);
  baseMdef = Number(parts[1] || 0);
  baseVit = Number(parts[2] || 0);
}

  function recalcMonsterStats() {
  const lv = getLv();
  if (!baseDef && !baseMdef && !baseVit) return;

  const def  = scaleByLevel(baseDef, lv);
  const mdef = scaleByLevel(baseMdef, lv);
  const vit  = scaleByLevel(baseVit, lv);

  defEl.value  = def;
  mdefEl.value = mdef;
  vitDisplayEl.textContent = vit;
}

  // 正式ダメージ（乱数は後回し：r=1.0で表示）
  function calcPhysicalDamage(atk, def, mdef, r = 1.0) {
    const raw = (atk * 1.75 - (def + mdef / 10)) * 4 * r;
    return Math.max(0, Math.floor(raw));
  }
  function calcMagicDamage(intv, def, mdef, r = 1.0) {
    const raw = (intv * 1.26 - (mdef + def / 10)) * 4 * r;
    return Math.max(0, Math.floor(raw));
  }

  // 「確実に通る最低ライン」：最悪乱数 r=0.9 でも 1以上
  function minAtkLine(def, mdef) {
    const r = 0.9;
    const need = (1 / (4 * r)) + (def + mdef / 10);
    return Math.ceil(need / 1.75);
  }
  function minIntLine(def, mdef) {
    const r = 0.9;
    const need = (1 / (4 * r)) + (mdef + def / 10);
    return Math.ceil(need / 1.26);
  }

  function updateMinLine() {
    const type = getAttackType();
    const def  = Number(defEl.value || 0);
    const mdef = Number(mdefEl.value || 0);

    if (type === "phys") {
      minlineEl.textContent = `確実に1以上出る最低ATK：${minAtkLine(def, mdef)}`;
    } else {
      minlineEl.textContent = `確実に1以上出る最低INT：${minIntLine(def, mdef)}`;
    }
  }

  function onMonsterOrLevelChanged() {
    loadMonsterBases();
    recalcMonsterStats();
    updateMinLine();
  }

// イベント
selectEl.addEventListener("change", () => {
  levelEl.value = 1; // モンスター切替でLv1に戻す（不要なら削除OK）
  onMonsterOrLevelChanged();
});

  levelEl.addEventListener("input", () => {
    recalcMonsterStats();
    updateMinLine();
  });

  document.querySelectorAll('input[name="attack-type"]').forEach(radio => {
    radio.addEventListener("change", updateMinLine);
  });

  calcBtn.addEventListener("click", () => {
    const type = getAttackType();
    const atk  = Number(atkEl.value || 0);
    const intv = Number(intEl.value || 0);
    const def  = Number(defEl.value || 0);
    const mdef = Number(mdefEl.value || 0);

    const dmg = (type === "phys")
      ? calcPhysicalDamage(atk, def, mdef, 1.0)
      : calcMagicDamage(intv, def, mdef, 1.0);

    resultEl.textContent = dmg;
    updateMinLine();
  });

// 初期化
onMonsterOrLevelChanged();
updateMinLine();
});
</script>

</div>

<script src="https://matsumoto0106.github.io/miko-onceworld-site/js/atk-calc.js"></script>


</main>

</body>
</html>
